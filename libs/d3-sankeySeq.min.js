!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3-interpolate"),require("d3-array"),require("d3-scale")):"function"==typeof define&&define.amd?define(["exports","d3-interpolate","d3-array","d3-scale"],e):e(n.d3=n.d3||{},n.d3,n.d3,n.d3)}(this,function(n,e,t,r){"use strict";function o(){function n(){E.forEach(function(n){n.sourceLinks=[],n.targetLinks=[]}),L.forEach(function(n){var e=n.source,t=n.target;"number"==typeof e&&(e=n.source=E[n.source]),"number"==typeof t&&(t=n.target=E[n.target]),e.sourceLinks.push(n),t.targetLinks.push(n)})}function o(){E.forEach(function(n){n.value=Math.max(t.sum(n.sourceLinks,a),t.sum(n.targetLinks,a))})}function u(){s=x?s:t.max(E,function(n){return n.value}),f=(k[1]/v.length-m)/s,y&&console.log("ky: "+f),E.forEach(function(n){n.dy=n.value*f,n.dx=h}),L.forEach(function(n){n.dy=n.value*f})}function c(){y&&console.log(k),l=r.scalePoint().domain(p).range([0,k[0]-h]),d=r.scalePoint().domain(v).range([k[1],k[1]/v.length]),E.forEach(function(n){n.x=l(n.nameX),n.y=d(n.nameY)-n.dy,y&&(console.log("x "+n.nameX+" -> "+l(n.nameX)),console.log("y "+n.nameY+" -> "+l(n.nameY)))}),y&&console.log(E)}function i(){function n(n,e){return n.source.y-e.source.y}function e(n,e){return n.target.y-e.target.y}E.forEach(function(t){t.sourceLinks.sort(e),t.targetLinks.sort(n)}),E.forEach(function(n){var e=0,t=0;n.sourceLinks.forEach(function(n){n.sy=e,e+=n.dy}),n.targetLinks.forEach(function(n){n.ty=t,t+=n.dy})})}function a(n){return n.value}var f,s,l,d,g={},y=!1,h=15,m=8,k=[700,500],p=[],v=[],x=!1,E=[],L=[];return g.debugOn=function(n){return arguments.length?(y=n,g):y},g.nodeWidth=function(n){return arguments.length?(h=+n,g):h},g.nodePadding=function(n){return arguments.length?(m=+n,g):m},g.nodes=function(n){return arguments.length?(E=n,g):E},g.links=function(n){return arguments.length?(L=n,g):L},g.sequence=function(n){return arguments.length?(p=n,g):p},g.categories=function(n){return arguments.length?(v=n,g):v},g.size=function(n){return arguments.length?(k=n,g):k},g.xScale=function(n){return arguments.length?(l=n,g):l},g.yScale=function(n){return arguments.length?(d=n,g):d},g.relayout=function(){return i(),g},g.link=function(){function n(n){var r=n.source.x+n.source.dx,o=n.target.x,u=e.interpolateNumber(r,o),c=u(t),i=u(1-t),a=n.source.y+n.sy+n.dy/2,f=n.target.y+n.ty+n.dy/2;return"M"+r+","+a+"C"+c+","+a+" "+i+","+f+" "+o+","+f}var t=.5;return n.curvature=function(e){return arguments.length?(t=+e,n):t},n},g.layout=function(){return n(),o(),u(),c(),i(),g},g.getNodeHeight=function(n){return n*f},g.maxValue=function(n){return arguments.length?-1===n?void(x=!1):(s=n,x=!0,g):s},g}n.sankeySeq=o,Object.defineProperty(n,"__esModule",{value:!0})});